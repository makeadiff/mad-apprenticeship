import{a as V,b as mt}from"https://st-p.rmcdn.net/aab27dd3/dist/c/c-HBHH3JOR.js";import{a as et}from"https://st-p.rmcdn.net/aab27dd3/dist/c/c-RQHQGLHW.js";import{A as St,f as tt}from"https://st-p.rmcdn.net/aab27dd3/dist/c/c-RWHY6I2B.js";import{a as C,d as Q}from"https://st-p.rmcdn.net/aab27dd3/dist/c/c-QHP3NFJY.js";function P(t,n){let a=`atom${++vt}`,p={toString:()=>a};return typeof t=="function"?p.read=t:(p.init=t,p.read=function(l){return l(this)},p.write=function(l,S,T){return S(this,typeof T=="function"?T(l(this)):T)}),n&&(p.write=n),p}var vt,q,L,k,Tt,ot,nt,rt,ht,N,it,R,Mt,j,st,$,ut,G=C(()=>{"use strict";vt=0;q=t=>"init"in t,L=t=>!!t.write,k=new WeakMap,Tt=(t,n)=>{k.set(t,n),t.catch(()=>{}).finally(()=>k.delete(t))},ot=(t,n)=>{let a=k.get(t);a&&(k.delete(t),a(n))},nt=(t,n)=>{t.status="fulfilled",t.value=n},rt=(t,n)=>{t.status="rejected",t.reason=n},ht=t=>typeof t?.then=="function",N=(t,n)=>!!t&&"v"in t&&"v"in n&&Object.is(t.v,n.v),it=(t,n)=>!!t&&"e"in t&&"e"in n&&Object.is(t.e,n.e),R=t=>!!t&&"v"in t&&t.v instanceof Promise,Mt=(t,n)=>"v"in t&&"v"in n&&t.v.orig&&t.v.orig===n.v.orig,j=t=>{if("e"in t)throw t.e;return t.v},st=()=>{let t=new WeakMap,n=new WeakMap,a=new Map,p,l;(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&(p=new Set,l=new Set);let S=e=>t.get(e),T=(e,r)=>{(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&Object.freeze(r);let s=t.get(e);if(t.set(e,r),a.has(e)||a.set(e,s),R(s)){let o="v"in r?r.v instanceof Promise?r.v:Promise.resolve(r.v):Promise.reject(r.e);s.v!==o&&ot(s.v,o)}},M=(e,r,s)=>{let o=new Map,u=!1;s.forEach((f,i)=>{!f&&i===e&&(f=r),f?(o.set(i,f),r.d.get(i)!==f&&(u=!0)):(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&console.warn("[Bug] atom state not found")}),(u||r.d.size!==o.size)&&(r.d=o)},g=(e,r,s)=>{let o=S(e),u={d:o?.d||new Map,v:r};if(s&&M(e,u,s),N(o,u)&&o.d===u.d)return o;if(R(o)&&R(u)&&Mt(o,u)){if(o.d===u.d)return o;u.v=o.v}return T(e,u),u},b=(e,r,s,o)=>{if(ht(r)){let u,f=()=>{let c=S(e);if(!R(c)||c.v!==i)return;let v=g(e,i,s);n.has(e)&&c.d!==v.d&&Y(e,v,c.d)},i=new Promise((c,v)=>{let d=!1;r.then(m=>{d||(d=!0,nt(i,m),c(m),f())},m=>{d||(d=!0,rt(i,m),v(m),f())}),u=m=>{d||(d=!0,m.then(A=>nt(i,A),A=>rt(i,A)),c(m))}});return i.orig=r,i.status="pending",Tt(i,c=>{c&&u(c),o?.()}),g(e,i,s)}return g(e,r,s)},h=(e,r,s)=>{let o=S(e),u={d:o?.d||new Map,e:r};return s&&M(e,u,s),it(o,u)&&o.d===u.d?o:(T(e,u),u)},w=(e,r)=>{let s=S(e);if(!r&&s&&(n.has(e)||Array.from(s.d).every(([d,m])=>{if(d===e)return!0;let A=w(d);return A===m||N(A,m)})))return s;let o=new Map,u=!0,f=d=>{if(d===e){let A=S(d);if(A)return o.set(d,A),j(A);if(q(d))return o.set(d,void 0),d.init;throw new Error("no atom init")}let m=w(d);return o.set(d,m),j(m)},i,c,v={get signal(){return i||(i=new AbortController),i.signal},get setSelf(){return(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!L(e)&&console.warn("setSelf function cannot be used with read-only atom"),!c&&L(e)&&(c=(...d)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&u&&console.warn("setSelf function cannot be called in sync"),!u)return U(e,...d)}),c}};try{let d=e.read(f,v);return b(e,d,o,()=>i?.abort())}catch(d){return h(e,d,o)}finally{u=!1}},y=e=>j(w(e)),D=e=>{let r=n.get(e);return r||(r=W(e)),r},_=(e,r)=>!r.l.size&&(!r.t.size||r.t.size===1&&r.t.has(e)),I=e=>{let r=n.get(e);r&&_(e,r)&&J(e)},O=e=>{let r=new Map,s=new WeakMap,o=i=>{var c;let v=new Set((c=n.get(i))==null?void 0:c.t);return a.forEach((d,m)=>{var A;(A=S(m))!=null&&A.d.has(i)&&v.add(m)}),v},u=i=>{o(i).forEach(c=>{c!==i&&(r.set(c,(r.get(c)||new Set).add(i)),s.set(c,(s.get(c)||0)+1),u(c))})};u(e);let f=i=>{o(i).forEach(c=>{var v;if(c!==i){let d=s.get(c);if(d&&s.set(c,--d),!d){let m=!!((v=r.get(c))!=null&&v.size);if(m){let A=S(c),pt=w(c,!0);m=!N(A,pt)}m||r.forEach(A=>A.delete(c))}f(c)}})};f(e)},x=(e,...r)=>{let s=!0,o=i=>j(w(i)),u=(i,...c)=>{let v;if(i===e){if(!q(i))throw new Error("atom not writable");let d=S(i),m=b(i,c[0]);N(d,m)||O(i)}else v=x(i,...c);if(!s){let d=z();(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&p.forEach(m=>m({type:"async-write",flushed:d}))}return v},f=e.write(o,u,...r);return s=!1,f},U=(e,...r)=>{let s=x(e,...r),o=z();return(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&p.forEach(u=>u({type:"write",flushed:o})),s},W=(e,r,s)=>{var o;let u=s||[];(o=S(e))==null||o.d.forEach((i,c)=>{let v=n.get(c);v?v.t.add(e):c!==e&&W(c,e,u)}),w(e);let f={t:new Set(r&&[r]),l:new Set};if(n.set(e,f),(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&l.add(e),L(e)&&e.onMount){let{onMount:i}=e;u.push(()=>{let c=i((...v)=>U(e,...v));c&&(f.u=c)})}return s||u.forEach(i=>i()),f},J=e=>{var r;let s=(r=n.get(e))==null?void 0:r.u;s&&s(),n.delete(e),(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&l.delete(e);let o=S(e);o?(R(o)&&ot(o.v),o.d.forEach((u,f)=>{if(f!==e){let i=n.get(f);i&&(i.t.delete(e),_(f,i)&&J(f))}})):(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&console.warn("[Bug] could not find atom state to unmount",e)},Y=(e,r,s)=>{let o=new Set(r.d.keys());s?.forEach((u,f)=>{if(o.has(f)){o.delete(f);return}let i=n.get(f);i&&(i.t.delete(e),_(f,i)&&J(f))}),o.forEach(u=>{let f=n.get(u);f?f.t.add(e):n.has(e)&&W(u,e)})},z=()=>{let e;for((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&(e=new Set);a.size;){let r=Array.from(a);a.clear(),r.forEach(([s,o])=>{let u=S(s);if(u){let f=n.get(s);f&&u.d!==o?.d&&Y(s,u,o?.d),f&&!(!R(o)&&(N(o,u)||it(o,u)))&&(f.l.forEach(i=>i()),(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&e.add(s))}else(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&console.warn("[Bug] no atom state to flush")})}if((import.meta.env?import.meta.env.MODE:void 0)!=="production")return e},Z=(e,r)=>{let s=D(e),o=z(),u=s.l;return u.add(r),(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&p.forEach(f=>f({type:"sub",flushed:o})),()=>{u.delete(r),I(e),(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&p.forEach(f=>f({type:"unsub"}))}};return(import.meta.env?import.meta.env.MODE:void 0)!=="production"?{get:y,set:U,sub:Z,dev_subscribe_store:(e,r)=>{if(r!==2)throw new Error("The current StoreListener revision is 2.");return p.add(e),()=>{p.delete(e)}},dev_get_mounted_atoms:()=>l.values(),dev_get_atom_state:e=>t.get(e),dev_get_mounted:e=>n.get(e),dev_restore_atoms:e=>{for(let[s,o]of e)q(s)&&(b(s,o),O(s));let r=z();p.forEach(s=>s({type:"restore",flushed:r}))}}:{get:y,set:U,sub:Z}};(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&(typeof globalThis.__NUMBER_OF_JOTAI_INSTANCES__=="number"?++globalThis.__NUMBER_OF_JOTAI_INSTANCES__:globalThis.__NUMBER_OF_JOTAI_INSTANCES__=1);ut=()=>($||((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&globalThis.__NUMBER_OF_JOTAI_INSTANCES__!==1&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"),$=st()),$)});function Et(t,n){let a=ct(n),[[p,l,S],T]=(0,E.useReducer)(b=>{let h=a.get(t);return Object.is(b[0],h)&&b[1]===a&&b[2]===t?b:[h,a,t]},void 0,()=>[a.get(t),a,t]),M=p;(l!==a||S!==t)&&(T(),M=a.get(t));let g=n?.delay;return(0,E.useEffect)(()=>{let b=a.sub(t,()=>{if(typeof g=="number"){setTimeout(T,g);return}T()});return T(),b},[a,t,g]),(0,E.useDebugValue)(M),At(M)?wt(M):M}function F(t,n){let a=ct(n);return(0,E.useCallback)((...l)=>{if((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&!("write"in t))throw new Error("not writable atom");return a.set(t,...l)},[a,t])}function B(t,n){return[Et(t,n),F(t,n)]}var E,gt,ct,At,wt,ft=C(()=>{"use strict";E=Q(et(),1);G();gt=(0,E.createContext)(void 0),ct=t=>{let n=(0,E.useContext)(gt);return t?.store||n||ut()},At=t=>typeof t?.then=="function",wt=E.default.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(t.status="pending",t.then(n=>{t.status="fulfilled",t.value=n},n=>{t.status="rejected",t.reason=n}),t)})});var H=C(()=>{"use strict";G();ft()});function lt(t,n){let a;function p(){typeof a=="function"&&a()}let l=P(t,(S,T,M)=>{let g=K(M)?M:M(S(l));T(l,g),p();let b=n(g);typeof b=="function"&&(a=b)});return l.onMount=()=>{let S=n(t);return typeof S=="function"&&(a=S),p},l}function K(t){return typeof t!="function"}var at=C(()=>{"use strict";H()});function X(t,n){return typeof n=="function"?lt(t,n):P(t)}function Wt(t,n,a){let p=typeof n<"u",l=p?X(n,a):null;function S(){if(l===null)throw new V("The store has not been initialized. Please initialize it before use.",{name:t});return B(l)}function T(){if(l===null)throw new V("The store has not been initialized. Please initialize it before use.",{name:t});return F(l)}function M(g){l=X(typeof g=="function"?g():g,a)}return p?{useStore:S,useSetState:T}:{initStore:M,useStore:S,useSetState:T}}function Jt(t,n,a){let p=typeof n<"u",l=p?X(n,a):null;function S(h,w,y){if(K(y))return{...w,[h]:y};{let D=typeof w[h]>"u"?{}:w[h],_=y(D);return{...w,[h]:_}}}function T(){if(l===null)throw new V("The store has not been initialized. Please initialize it before use.",{name:t});let[h,w]=B(l);function y(D,_){w(I=>S(D,I,_))}return[h,y]}function M(){if(l===null)throw new V("The store has not been initialized. Please initialize it before use.",{name:t});return F(l)}function g(h,w){if(l===null)throw new V("The store has not been initialized. Please initialize it before use.",{name:t});let y=(0,dt.useMemo)(function(){return P(function(I){if(l===null)throw new V("The store has not been initialized. Please initialize it before use.",{name:t});let O=I(l)[h];return typeof O>"u"&&typeof w<"u"?w:tt(O)},function(I,O,x){if(l===null)throw new V("The store has not been initialized. Please initialize it before use.",{name:t});let U=I(l);O(l,S(h,U,x))})},[h]);return B(y)}function b(h){l=P(typeof h=="function"?h():h)}return p?{useStore:T,useItem:g,useSetState:M}:{initStore:b,useStore:T,useItem:g,useSetState:M}}var dt,bt=C(()=>{"use strict";dt=Q(et());St();H();mt();at()});export{Wt as a,Jt as b,bt as c};
