import{Q as C,R as b}from"https://st-p.rmcdn.net/aab27dd3/dist/c/c-LKHQPPXC.js";import{a as I,b as P,c as d,d as D}from"https://st-p.rmcdn.net/aab27dd3/dist/c/c-ESZBX7KW.js";import{a as x}from"https://st-p.rmcdn.net/aab27dd3/dist/c/c-234U5CBJ.js";import{e as R,f as l,k as O}from"https://st-p.rmcdn.net/aab27dd3/dist/c/c-CKAFNI2U.js";import{a as n,b as o,d as y,e as M,f as v}from"https://st-p.rmcdn.net/aab27dd3/dist/c/c-WMCMTIVL.js";import{b as s,c as k}from"https://st-p.rmcdn.net/aab27dd3/dist/c/c-XISRCAED.js";import{a as S}from"https://st-p.rmcdn.net/aab27dd3/dist/c/c-7E6CHA26.js";import{b as w}from"https://st-p.rmcdn.net/aab27dd3/dist/c/c-6ZBEBUM2.js";import{d as u}from"https://st-p.rmcdn.net/aab27dd3/dist/c/c-QHP3NFJY.js";var r=u(w()),p=u(x());k();var A=u(S()),m=u(w());D();k();O();b();v();var T={initialize:function(t){m.default.bindAll(this),m.default.extend(this,t),this.currentData=this._initCurrentData(),window.gtag&&this.currentData.userId&&!window.RM.common.isDownloadedSource&&window.gtag("set",{user_id:this.currentData.userId}),(0,A.default)(m.default.bind(function(){this.initialTracking()},this))},initialTracking(){let t=n("_rm_reg_cookie"),i=n("_rm_join_analytics_data");this.trackPage(),t&&(o("_rm_reg_cookie"),l.sendConversionEvent({CONVERSION_ID:s.GOOGLE_ADS_ID,CONVERSION_LABEL:s.GOOGLE_CONVERSION_LABEL_REGISTRATION,value:15,transaction_id:"",...this.currentData.userEmail&&{user_data:{email:this.currentData.userEmail}}}),l.sendEventToLinkedInInsights({partnerId:s.linkedInPartnerId,eventId:R.Registration})),i&&o("_rm_join_analytics_data")},sendEvent:function(t,i){if(!window.gtag||RM.constructorRouter&&RM.constructorRouter.previewMode)return;let e={};m.default.isObject(i)?e=m.default.extend(e,i):e.rm_parameter=i||void 0,window.gtag("event",t,{userId:this.currentData.userId,campaign:{name:this._rmdata?.first_campaign,source:this._rmdata?.first_source,medium:this._rmdata?.first_medium},c_id:this.currentData.gacid,rm_parameter:e.rm_parameter})},trackPage:function(){window.gtag&&(RM.constructorRouter&&RM.constructorRouter.previewMode||C()||window.gtag("event","page_view",{userId:this.currentData.userId,campaign:{name:this._rmdata?.first_campaign,source:this._rmdata?.first_source,medium:this._rmdata?.first_medium},c_id:this.currentData.gacid}))},_initCurrentData:function(){let t={};t.userId=null,window.ServerData.me&&(t.userId=window.ServerData.me._id||window.ServerData.me.user&&window.ServerData.me.user._id,t.userEmail=window.ServerData.me.email||window.ServerData.me.user&&window.ServerData.me.user.email),t.gacid=d.getGAcid();let i=n("_rmdata");return i&&(this._rmdata=JSON.parse(atob(i))),t}},f=T;var U={},g=U;var _=u(w());D();P();v();var H={initialize:function(t){_.default.bindAll(this),_.default.extend(this,t),this.shortlink_redirect=n("shortlink_redirect"),this.initialTracking(),this.ecommerceEvents=["add_to_cart","view_cart","remove_from_cart","begin_checkout","purchase"]},setClientIdFromCookie:function(){let t=n("_ga");if(t){let i=t.match(/GA[0-9]+\.[0-9]+\.(.*)/);this.clientId=i.length>1?i[1]:void 0,this.clientId&&window.gtag("set",{client_id:this.clientId})}},sendEvent:function(t,i){if(!window.gtag)return;if(!RM.common.isDomainViewer){let c=window.ServerData&&!window.ServerData.isCountryInEU&&window.Cookiebot&&!window.Cookiebot.declined,E=window.Cookiebot&&window.Cookiebot.consent.statistics;if(window.ServerData&&window.ServerData.isCountryInEU){if(!E&&!RM.common.isDomainViewer)return}else if(!c&&!RM.common.isDomainViewer)return}this.setClientIdFromCookie();let e={};if(_.default.isObject(i)?(e.rm_parameter=i.parameter,e.ecommerceData=i.ecommerceData):e.rm_parameter=i,RM.common.readymagTracker&&RM.common.isProjectOwnedByRM&&!this.ecommerceEvents.includes(t)){let c={userId:this.userId,firstCampaign:this._rmdata&&this._rmdata.first_campaign,firstMedium:this._rmdata&&this._rmdata.first_medium,campaign:{name:this._rmdata&&this._rmdata.first_campaign,source:this._rmdata&&this._rmdata.first_source,medium:this._rmdata&&this._rmdata.first_medium},c_id:this.clientId,rm_parameter:e.rm_parameter};window.gtag("event",t,c)}if(RM.common.userTracker&&!RM.common.homepageRewrite){let c={rm_parameter:e.rm_parameter,...e.ecommerceData?e.ecommerceData:void 0};window.gtag("event",t,c)}},trackPage:function(){window.gtag&&(this.setClientIdFromCookie(),RM.common.readymagTracker&&RM.common.isProjectOwnedByRM&&window.gtag("event","page_view",{userId:this.userId,firstCampaign:this._rmdata&&this._rmdata.first_campaign,firstMedium:this._rmdata&&this._rmdata.first_medium,campaign:{name:this._rmdata&&this._rmdata.first_campaign,source:this._rmdata&&this._rmdata.first_source,medium:this._rmdata&&this._rmdata.first_medium},c_id:this.clientId}),RM.common.userTracker&&window.gtag("event","page_view"),RM.common.readymagTracker&&RM.common.isProjectOwnedByRM&&(d.initLinkedInInsights(),d.trackPixelPageView()))},_processRedirectUTM:function(){if(!this.shortlink_redirect)return;let t=JSON.parse(atob(this.shortlink_redirect));return o("shortlink_redirect"),{campaignName:t.utm_campaign,campaignSource:t.utm_source,campaignMedium:t.utm_medium}},initialTracking:function(){this._rmdata=y(),M(),RM.common.isDomainViewer?this.trackPage():d.loadLoggedUser(t=>{I.waitForCookieConsent().then(i=>{if(!i.statistics){o("_rmdata"),o("_rm_amp_data");return}t&&t._id&&(this.userId=t._id,window.gtag&&window.gtag("set",{user_id:t._id}),window?.amplitude?.setUserId(t._id),n("_rm_amp_data")&&o("_rm_amp_data")),this.trackPage()})})}},h=H;var a={};if(typeof window<"u"){if(location.origin===s.readymag_auth_host&&f?a=p.default.Model.extend(r.default.extend(r.default.extend(a,f),g)):h?a=p.default.Model.extend(r.default.extend(r.default.extend(a,h),g)):console.error("Analytics initialization error!"),window.RM&&window.RM.customAnalyticsHandlers&&!r.default.isEmpty(window.RM.customAnalyticsHandlers.event)){let t=a.prototype.sendEvent;a.prototype.sendEvent=function(){if(!window.ga)return;let i=t.apply(this,arguments);return window.RM.customAnalyticsHandlers&&r.default.isFunction(window.RM.customAnalyticsHandlers.run)&&window.RM.customAnalyticsHandlers.run("event",i),i}}if(window.RM&&window.RM.customAnalyticsHandlers&&!r.default.isEmpty(window.RM.customAnalyticsHandlers.track)){let t=a.prototype.trackPage;a.prototype.trackPage=function(){if(!window.ga)return;let i=t.apply(this,arguments);return i&&window.RM.customAnalyticsHandlers&&r.default.isFunction(window.RM.customAnalyticsHandlers.run)&&window.RM.customAnalyticsHandlers.run("track",i),i}}}var Y=a;export{Y as a};
